$url="https://bitbucket.org/nbradford/powernsx/raw/Dev/Tools/Profiling/NSXCustomerProfileInstaller.ps1"; try { $wc = new-object Net.WebClient; try { $wc.DownloadFile($url,"$env:temp\$([System.IO.Path]::GetFileName($url))") } catch { if ( $_.exception.innerexception -match "(407)") { $wc.proxy.credentials = Get-Credential -Message "Proxy Authentication Required"; $wc.DownloadFile($url,"$env:temp\$([System.IO.Path]::GetFileName($url))") } else { throw $_ }}; & "$env:temp\$([System.IO.Path]::GetFileName($url))" } catch {  throw $_ }